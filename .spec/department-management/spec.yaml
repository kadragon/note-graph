spec_id: SPEC-dept-1
title: "Department Management"
description: >
  Manage organizational departments and view department-related
  persons and work notes.

given_when_then:
  - given: "No departments exist"
    when: "User creates department with name '교무기획부'"
    then: "Department is created with name as primary key"

  - given: "Department exists"
    when: "User views department detail"
    then: >
      Current members (persons with is_active=true for this dept),
      historical members (all persons ever in dept),
      and related work notes are shown

  - given: "Multiple persons assigned to department"
    when: "User requests department member list"
    then: "Only persons with current assignment (is_active=true) are returned"

acceptance_tests:
  - id: TEST-dept-1
    desc: "Create department"
    steps:
      - "POST /departments with deptName and description"
      - "Verify department created"
      - "GET /departments/{deptName} returns created department"

  - id: TEST-dept-2
    desc: "List current department members"
    steps:
      - "Create department"
      - "Assign person A to department (is_active=true)"
      - "Assign person B to different department"
      - "Move person C from department (is_active=false)"
      - "Request department members"
      - "Verify only person A returned"

  - id: TEST-dept-3
    desc: "List department work notes"
    steps:
      - "Create department"
      - "Create work note with person from this department"
      - "GET /departments/{deptName}/work-notes"
      - "Verify work note included in results"

dependencies:
  governance:
    - "Department naming convention (Korean names used as codes)"

linked_tasks: []

technical_notes:
  - "dept_name serves as both human-readable name and primary key"
  - "No separate dept_code - simplifies data model for single-user system"
  - "Department members derived from person_dept_history.is_active"
  - "Department work notes found via work_note_person join"

database_schema:
  departments:
    - dept_name TEXT PRIMARY KEY
    - description TEXT
    - created_at TEXT

api_endpoints:
  - method: GET
    path: /departments

  - method: POST
    path: /departments

  - method: GET
    path: /departments/{deptName}

  - method: PUT
    path: /departments/{deptName}

  - method: GET
    path: /departments/{deptName}/work-notes
