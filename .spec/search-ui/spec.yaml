spec_id: SPEC-search-ui-1
title: "Search Page Stability (No Request Loop)"
description: >
  Ensure the /search page triggers exactly one unified search request per query change
  and never enters a re-render/request loop that spams the backend and crashes the UI.

given_when_then:
  - given: "User opens /search?q=수"
    when: "Search page mounts and reads URL query params"
    then: "Exactly one POST /search/unified request is issued for the query"

  - given: "User changes the query parameter from '수' to '수업'"
    when: "Search page observes the new URL param"
    then: "A new unified search request is issued once for the updated query"

  - given: "User clears the query parameter (q=)"
    when: "Search page observes an empty query"
    then: "No unified search request is issued"

acceptance_tests:
  - id: TEST-search-ui-1
    desc: "No request loop on initial load"
    steps:
      - "Open /search?q=수"
      - "Verify only one request to /api/search/unified is made"
      - "Verify UI remains responsive (no repeated error toasts)"

  - id: TEST-search-ui-2
    desc: "One request per query change"
    steps:
      - "Open /search?q=수"
      - "Change URL to /search?q=수업"
      - "Verify exactly one additional request is made for the new query"

dependencies:
  governance: []
linked_tasks:
  - TASK-068

