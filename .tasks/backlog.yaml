tasks:
  - task_id: TASK-047
    spec_id: SPEC-stats-1
    title: "Statistics backend - repository and API"
    description: |
      Implement backend infrastructure for work note statistics:
      - WorkNoteRepository methods for querying completed work notes by date range
      - Statistics calculation methods (totals, completion rates, distributions)
      - StatisticsRepository for aggregation queries
      - API endpoints: GET /api/statistics?period=...&year=...
      - Support filtering by person, department, category
    priority: 2
    status: pending
    estimated_effort: 6h
    acceptance_criteria:
      - "Repository queries work notes with at least one completed todo in date range"
      - "Statistics endpoint returns summary metrics (counts, rates, distributions)"
      - "Period filters work correctly (week, month, half-year, year, last-week)"
      - "Year selector parameter filters to specific year"
      - "Integration tests verify query accuracy"

  - task_id: TASK-048
    spec_id: SPEC-stats-1
    title: "Statistics frontend - UI and visualization"
    description: |
      Implement frontend statistics dashboard:
      - Create /statistics route and page component
      - Period filter tabs (이번주, 이번달, 1~6월, 7~12월, 올해, 직전주)
      - Year selector dropdown
      - Summary cards component for key metrics
      - Chart components (bar chart, pie chart) for distributions
      - Work note list table with completed todo counts
      - Date calculation utilities for period boundaries
    priority: 2
    status: pending
    estimated_effort: 7h
    acceptance_criteria:
      - "Statistics page accessible via navigation menu"
      - "Period filter tabs switch data correctly"
      - "Year selector updates statistics for selected year"
      - "Summary cards display total work notes, completed todos, completion rate"
      - "Charts visualize category and person distributions"
      - "Work note list shows filtered results with completion info"

  - task_id: TASK-049
    spec_id: SPEC-stats-1
    title: "Statistics comprehensive tests"
    description: |
      Create comprehensive test suite for statistics feature:
      - Repository unit tests for date range queries
      - Repository tests for completion criteria (at least one completed todo)
      - API integration tests for all period filters
      - Statistics calculation accuracy tests
      - Frontend component tests for charts and filters
      - E2E tests for period switching and year selection
    priority: 2
    status: pending
    estimated_effort: 4h
    acceptance_criteria:
      - "Repository tests cover all period calculations"
      - "API tests verify correct filtering and aggregation"
      - "Frontend tests verify chart rendering and interaction"
      - "All acceptance tests from SPEC-stats-1 pass"
      - "Test coverage >= 80% for statistics module"

  - task_id: TASK-024
    spec_id: SPEC-worknote-1
    title: "Add searchable assignee selector for work notes"
    description: |
      Replace the checkbox grid assignee picker with a searchable multi-select
      (cmdk + popover). Improves UX for large person lists with keyboard
      navigation and badge-style selections.
    priority: 3
    status: paused
    estimated_effort: 3h
    acceptance_criteria:
      - "Users can search persons by name or ID when assigning"
      - "Multi-select with badges and keyboard navigation works"
      - "Create and view dialogs both use the new selector"

  - task_id: TASK-025
    spec_id: SPEC-person-1
    title: "Add edit person dialog from list"
    description: |
      Make person rows clickable to open a shared create/edit dialog, with
      prefilled data and PUT /persons/:personId integration. Person ID remains
      immutable in edit mode.
    priority: 3
    status: paused
    estimated_effort: 4h
    acceptance_criteria:
      - "Clicking a person row opens edit dialog with existing data"
      - "Person ID field is disabled in edit mode"
      - "Successful save updates list and shows toast"

  - task_id: TASK-021
    spec_id: SPEC-person-1
    title: "Improve department search UX in person form"
    description: |
      Add loading/error feedback, keyboard navigation, and limit search results
      to 5 items with debounced async queries for the department selector in the
      person creation form.
    priority: 4
    status: pending
    estimated_effort: 2h
    acceptance_criteria:
      - "Debounced search shows up to 5 suggestions"
      - "Loading and error states visible during search"
      - "Keyboard arrows/Enter select suggestions"

  - task_id: TASK-020
    spec_id: SPEC-person-1
    title: "Debounced department search in person form"
    description: |
      When the department list is large, typing in the person creation form
      should trigger debounced, asynchronous department search and update the
      selectable list without reloading the page.
    priority: 4
    status: pending
    estimated_effort: 2h
    acceptance_criteria:
      - "Department input fetches filtered results as user types (debounce)"
      - "Empty input shows the full list"
      - "Newly added department still appears and remains selectable"

  - task_id: TASK-018
    spec_id: SPEC-auth-1
    title: "Configure Cloudflare Access and deploy"
    description: |
      Set up production environment.
      - Configure Cloudflare Access with Google OAuth
      - Set up AI Gateway with rate limits
      - Create production D1 database
      - Create Vectorize index
      - Set up R2 bucket with lifecycle rules
      - Configure Queue
      - Deploy Workers
      - Test end-to-end in production
    priority: 6
    status: pending
    estimated_effort: 4h
    acceptance_criteria:
      - "Production environment fully functional"
      - "Authentication works"
      - "All services integrated"

  - task_id: TASK-019
    spec_id: SPEC-worknote-1
    title: "Write user documentation"
    description: |
      Create user guide and developer documentation.
      - User guide (Korean) with screenshots
      - API documentation (auto-generated from OpenAPI spec)
      - Developer setup guide
      - Architecture overview
      - Deployment guide
    priority: 6
    status: pending
    estimated_effort: 6h
    acceptance_criteria:
      - "User guide complete"
      - "API docs published"
      - "Setup guide tested by new user"

metadata:
  total_tasks: 9
  total_estimated_effort: 38 hours
  phases:
    - name: "Statistics Feature"
      tasks: [TASK-047, TASK-048, TASK-049]
      effort: 17h
      priority: 2

    - name: "Entity Management"
      tasks: [TASK-024, TASK-025, TASK-020, TASK-021]
      effort: 11h
      priority: 3-4

    - name: "Deployment & Docs"
      tasks: [TASK-018, TASK-019]
      effort: 10h
      priority: 6
